# KEK

## Краткое описание:
  В данном документе постараюсь описать, что планирую сделать и что сделал по проекту КЕК.
На какие сегменты он делится и как выполняется. Что я сделал для реализации.
### Цель:
Создание проекта видеохостинга для знакомства с различными технологиями. Ну и если получится, то использование проекта для домашнего кинотеатра.
### Используемые технологии

    python 3.10
        flask
    Virual Box
    Ubuntu 20.04

### Планируемые технологии

    Docker
    Nginx

Составляющие
Виртуальная машина
Установка вирутальной машины
Настройка вируальной машины
Authserver
Уже есть:

    Регистрация нового пользователя
    Логин
    Отображение данных в на домашней страничке пользователя

Используемые библиотеки

    flask
    flask-login
    flask-sqlalchemy

Планируемые изменения

    Добавить картинки с аватарками пользователя
    Добавить опцию изменения данных в личном кабинете


## Арихитектура

### фронт
Фронтенд приложение SPA на фреймворке VUE.js версии 3.
При написании стараюсь придерживаться FSD (feature-slide design)

#### Страница с афишей




### бэк






###





## Структура и функциональность:

### Веб приложение


#### Страница с афишей на следующий месяц

#### Страница с историей просмотров:


# План действий:

Для создания системы потоковой передачи видео с использованием NGINX с модулем RTMP и клиентского приложения на Vue.js, архитектура решения может выглядеть следующим образом:

    NGINX с модулем RTMP: Это медиасервер, который будет обрабатывать потоковую передачу видео. Вы должны установить NGINX с поддержкой модуля RTMP и настроить его для приема и передачи видео потоков.

    Хранение видео: Видеофайлы могут храниться на сервере в определенном каталоге. NGINX RTMP позволяет определить конфигурацию для хранения видео и метаданных о потоках.

    Клиентское приложение на Vue.js: Это ваш веб-клиент, который будет показывать видео и управлять потоками. Вам нужно создать страницу Vue.js, на которой будет проигрываться видео и отправляться видео на медиасервер.

    Протокол RTMP: Для передачи видеопотоков между клиентским приложением и медиасервером будет использоваться протокол RTMP (Real-Time Messaging Protocol). Вы должны настроить клиентское приложение для отправки видео на медиасервер через RTMP.

    Обратный прокси (опционально): Обратный прокси (например, NGINX или другой HTTP-сервер) может использоваться для маршрутизации запросов клиентов к серверу RTMP. Это позволит управлять доступом к видеопотокам и обеспечивать безопасность.

    Бекэнд-сервер (опционально): Если требуется управление пользователями, правами доступа или метаданными о видео, вы можете создать бекэнд-сервер. Этот сервер будет взаимодействовать с клиентским приложением и медиасервером для управления видеопотоками.

Шаги для настройки системы:

    Установите и настройте NGINX с модулем RTMP на сервере для потоковой передачи видео.

    Создайте страницу Vue.js, которая будет использоваться в качестве клиентского приложения для отправки и приема видео.

    Настройте клиентское приложение для отправки видео на медиасервер через RTMP.

    На сервере определите место для хранения видео и создайте конфигурацию NGINX RTMP для управления потоками и записью видео.

    Опционально, настройте обратный прокси, если это необходимо для вашего использования.

    Поддерживайте бекэнд-сервер, если требуется дополнительная функциональность, такая как аутентификация и управление доступом.

Важно также учитывать безопасность и уровень доступа к видеопотокам, чтобы обеспечить защиту видеоматериалов и предотвратить несанкционированный доступ.

Обратите внимание, что настройка медиасервера и клиентского приложения может потребовать дополнительных шагов в зависимости от конкретных требований вашего проекта и технологических деталей.


Да, вы можете установить NGINX с модулем RTMP на виртуальной машине, работающей под управлением Ubuntu в VirtualBox. Виртуальные машины предоставляют изолированное окружение, в котором вы можете устанавливать и настраивать программное обеспечение для тестирования и тренировки.

Вот общие шаги по установке NGINX с модулем RTMP на виртуальной машине Ubuntu в VirtualBox:

    Установите VirtualBox: Если вы еще не установили VirtualBox, сначала загрузите и установите его на вашем хост-компьютере.

    Создайте виртуальную машину Ubuntu: Создайте новую виртуальную машину в VirtualBox и выберите образ диска Ubuntu для установки.

    Установите Ubuntu: Запустите виртуальную машину и выполните установку Ubuntu в соответствии с инструкциями на экране.

    Обновите пакеты: После установки Ubuntu обновите список пакетов и установите обновления с помощью следующих команд:

    sql

sudo apt update
sudo apt upgrade

Установите NGINX с модулем RTMP: Выполните команду для установки NGINX с модулем RTMP:

lua

sudo apt install nginx libnginx-mod-rtmp

Настройте NGINX RTMP: Создайте конфигурационный файл для NGINX RTMP, например, /etc/nginx/nginx.conf или /etc/nginx/conf.d/rtmp.conf, и настройте его в соответствии с вашими потребностями. Пример конфигурации RTMP может выглядеть так:

nginx

rtmp {
    server {
        listen 1935;
        application live {
            live on;
            allow publish all;
            allow play all;
        }
    }
}

Запустите NGINX: Запустите NGINX с помощью команды:

sql

sudo systemctl start nginx

Проверьте статус NGINX: Убедитесь, что NGINX запущен и работает без ошибок:

lua

    sudo systemctl status nginx

    Настройте клиентское приложение: Создайте клиентское приложение, которое будет отправлять видео на медиасервер через RTMP.

Это базовые шаги для установки NGINX с модулем RTMP на виртуальной машине Ubuntu. После этого вы можете начать тестировать потоковую передачу видео в вашей виртуальной среде.

Обратите внимание, что важно настроить безопасность и доступ к вашему медиасерверу в соответствии с вашими требованиями и локальными правилами безопасности.
User
А где хранить видео на таком сервере и что еще надо настроить в nginx чтобы начать передавать видео?
ChatGPT

Для потоковой передачи видео с использованием NGINX с модулем RTMP вам потребуется место для хранения видеофайлов и несколько дополнительных настроек NGINX. Вот шаги по настройке:

    Хранение видеофайлов: Вы можете хранить видеофайлы на сервере, где установлен NGINX, в локальной файловой системе. Это может быть определенная директория на сервере, например, /var/www/videos, где будут располагаться ваши видеофайлы. Вам также нужно убедиться, что на сервере есть достаточно места для хранения видеоконтента.

    Настройка NGINX с модулем RTMP: Создайте конфигурационный файл для модуля RTMP, который будет определять приложение RTMP и указывать на директорию с видеофайлами. Вам нужно добавить эту конфигурацию в файл, например, /etc/nginx/nginx.conf или /etc/nginx/conf.d/rtmp.conf. Пример конфигурации может выглядеть так:

    nginx

rtmp {
    server {
        listen 1935;
        application live {
            live on;
            allow publish all;
            allow play all;
            hls on;
            hls_path /var/www/hls;
            hls_fragment 3;
            hls_playlist_length 60;
        }
    }
}

В данной конфигурации мы включили HLS (HTTP Live Streaming) и указали путь /var/www/hls для хранения HLS-сегментов видео. Вы также можете указать свой собственный путь для хранения сегментов.

Создание HLS-потока: HLS - это формат потока, который чаще всего используется для воспроизведения видео в браузерах и мобильных устройствах. После настройки NGINX RTMP, вы можете создать поток HLS из вашего видеоконтента с помощью команды FFmpeg:

bash

    ffmpeg -i /путь/к/вашему/видео.mp4 -c:v h264 -c:a aac -strict -2 -f flv rtmp://ваш_сервер/live/stream_name

    Где /путь/к/вашему/видео.mp4 - это путь к вашему видеофайлу, ваш_сервер - это адрес вашего сервера, stream_name - имя вашего потока.

    Воспроизведение видео: Для воспроизведения видео вам потребуется клиентское приложение, поддерживающее воспроизведение потокового HLS-видео. Вы можете использовать HTML5 video элемент с поддержкой HLS или сторонние плееры для воспроизведения видеопотока на вашей веб-странице.

    Настройка доступа: Важно учесть безопасность и ограничить доступ к потокам и видеофайлам в соответствии с вашими требованиями. Вы можете настроить доступ по паролю, использовать токены для аутентификации или реализовать другие меры безопасности.

Это базовые шаги для настройки потоковой передачи видео с использованием NGINX с модулем RTMP. После выполнения этих шагов вы сможете начать передачу и воспроизведение видео на вашем сервере.

А разве не по RTMP мы планировали передавать видео?
ChatGPT

Прошу прощения за недоразумение. Если вы планируете использовать RTMP (Real-Time Messaging Protocol) для потоковой передачи видео, то архитектура и настройки будут немного отличаться. Вот какие шаги и элементы необходимы:

    Медиасервер с поддержкой RTMP: Вам понадобится медиасервер, который поддерживает RTMP. NGINX с модулем RTMP - хороший выбор. Вы можете установить и настроить NGINX с поддержкой RTMP на вашем сервере.

    Хранение видеофайлов: Видеофайлы, которые вы планируете транслировать, должны храниться на сервере. Это может быть директория с видеофайлами, например, /var/www/videos.

    Настройка NGINX RTMP: Создайте конфигурационный файл для NGINX с модулем RTMP, в котором определите приложение RTMP и путь к вашим видеофайлам. Пример конфигурации:

    nginx

rtmp {
    server {
        listen 1935;
        application myapp {
            live on;
            exec_push ffmpeg -i rtmp://localhost/myapp/$name -c:v copy -c:a aac -f flv rtmp://localhost/show/$name;
            exec_push ffmpeg -i rtmp://localhost/myapp/$name -c:v copy -c:a aac -f flv rtmp://localhost/hls/$name;
        }
    }
}

Это пример конфигурации, который передает потоки в два разных формата: FLV и HLS. Вы можете настроить это под свои требования.

FFmpeg для передачи видео: Для отправки видеопотока на медиасервер в реальном времени, вы можете использовать FFmpeg. Пример команды для передачи видео на медиасервер:

bash

    ffmpeg -i /путь/к/вашему/видео.mp4 -f flv rtmp://ваш_сервер/myapp/stream_name

    Где /путь/к/вашему/видео.mp4 - это путь к вашему видеофайлу, ваш_сервер - это адрес вашего сервера, stream_name - имя вашего потока.

    Плеер на клиентской стороне: Для просмотра потокового видео на клиентской стороне вам потребуется HTML5 плеер, который поддерживает воспроизведение RTMP-потоков.

    Настройка доступа и безопасности: Обеспечьте безопасность путем ограничения доступа к вашим RTMP-потокам. Можно настроить аутентификацию и авторизацию для трансляций.

После настройки всех этих компонентов вы сможете передавать и просматривать видео в режиме реального времени с использованием протокола RTMP.